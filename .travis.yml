language: python
sudo: false
cache:
- pip
python:
- '3.6'
env:
  global:
  - secure: eO08tZokK+Etpp4ISvxVaWHe5tN6PC/SzLHcltqgvqRYa7L9zY5NKQjiY5LvUw1onnbbSPMnTabFWrcw3VtoQ1he5M2NbqqTSLTxT9dSWXhy6KRymNXVkEv4Ar6WWiQDUPlyMY7XTG35G5jo6C3LBer5FRKDpEAPlw51z4TyML0=
  matrix:
  - DJANGO="Django<1.9,>=1.8"
  - DJANGO="Django<1.10,>=1.9"
  - DJANGO="-e git+https://github.com/django/django.git#egg=Django"
matrix:
  allow_failures:
  - env: DJANGO="-e git+https://github.com/django/django.git#egg=Django"
install:
- pip install -U pip
- pip install -r requirements-dev.txt
- pip install $DJANGO
- pip install coveralls
script:
- isort --check-only --recursive --diff .
- coverage run --source=closeio -m 'pytest'
after_success: coveralls
deploy:
  provider: pypi
  user: codingjoe
  password:
    secure: EbCAfnLxHzVgyPe/4f1w5wbgBMrEjiPw/olfaDS0kIJjNFuAuWGiqyVQaSPgLsBteD9dYUuU/O95eVy1W5tYFySTc8FEXXXI7YBTMHZN+aFQzFoBcvE6g5npvPAdUU0W53g+13wiAUI9tMFTnOf0rG585qmzMEu0NY6R2dEOtTo=
  on:
    tags: true
    distributions: sdist bdist_wheel
    repo: Thermondo/closeio
